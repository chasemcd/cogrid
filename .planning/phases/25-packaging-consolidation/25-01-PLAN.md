---
phase: 25-packaging-consolidation
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - pyproject.toml
  - cogrid/__init__.py
  - README.md
  - setup.py
  - setup.cfg
  - MANIFEST.in
  - requirements.txt
  - docs/requirements.txt
  - update_pypi.sh
  - .readthedocs.yaml
  - README.rst
autonomous: true

must_haves:
  truths:
    - "`pip install -e .` installs CoGrid successfully using pyproject.toml as the sole packaging config"
    - "`pip install -e '.[jax]'` installs JAX backend; `pip install -e '.[dev]'` installs test/lint/docs tools; `pip install -e '.[docs]'` installs MkDocs stack"
    - "`python -c \"import cogrid; print(cogrid.__version__)\"` prints 0.0.16"
    - "No legacy packaging files (setup.py, setup.cfg, MANIFEST.in, requirements.txt, docs/requirements.txt, update_pypi.sh, .readthedocs.yaml) remain in the repository"
    - "README.md exists with Markdown formatting and project badges"
  artifacts:
    - path: "pyproject.toml"
      provides: "Complete PEP 621 metadata, dependency specs, optional extras, ruff config, pytest config"
      contains: "[project]"
    - path: "cogrid/__init__.py"
      provides: "Package version exposed at runtime"
      contains: "__version__"
    - path: "README.md"
      provides: "Markdown README with badges and installation instructions"
  key_links:
    - from: "pyproject.toml"
      to: "cogrid/__init__.py"
      via: "dynamic version attr"
      pattern: 'version = \\{attr = "cogrid.__version__"\\}'
---

<objective>
Create the complete pyproject.toml with all metadata, dependencies, optional extras, ruff config, and pytest config. Add `__version__` to `cogrid/__init__.py`. Convert README from RST to Markdown. Remove all legacy packaging files and stale build artifacts.

Purpose: Establish pyproject.toml as the single source of truth for packaging, replacing 7 legacy files.
Output: Working `pip install -e .` with optional extras, runtime version access, clean Markdown README.
</objective>

<execution_context>
@/Users/chasemcd/.claude/get-shit-done/workflows/execute-plan.md
@/Users/chasemcd/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/25-packaging-consolidation/25-RESEARCH.md
@.planning/phases/25-packaging-consolidation/25-CONTEXT.md
@cogrid/__init__.py
@pyproject.toml
@setup.py
@setup.cfg
@README.rst
@requirements.txt
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create complete pyproject.toml, add __version__, convert README</name>
  <files>
    pyproject.toml
    cogrid/__init__.py
    README.md
  </files>
  <action>
**pyproject.toml** -- Replace the existing 3-line skeleton with the full PEP 621 config. Use setuptools as build backend (per research recommendation). Include all sections:

```toml
[build-system]
requires = ["setuptools>=68", "wheel"]
build-backend = "setuptools.build_meta"

[project]
name = "cogrid"
dynamic = ["version"]
description = "A library for creating multi-agent grid-world environments for reinforcement learning."
readme = "README.md"
requires-python = ">=3.10"
license = "Apache-2.0"
authors = [
    {name = "Chase McDonald", email = "chasemcd@cmu.edu"},
]
keywords = ["reinforcement-learning", "multi-agent", "gridworld", "gymnasium", "pettingzoo"]
classifiers = [
    "Development Status :: 3 - Alpha",
    "Programming Language :: Python :: 3",
    "Programming Language :: Python :: 3.10",
    "Programming Language :: Python :: 3.11",
    "Programming Language :: Python :: 3.12",
    "License :: OSI Approved :: Apache Software License",
    "Operating System :: OS Independent",
    "Intended Audience :: Science/Research",
    "Topic :: Scientific/Engineering :: Artificial Intelligence",
]
dependencies = [
    "numpy>=1.26,<3.0",
    "gymnasium>=0.29",
    "pettingzoo>=1.24",
]

[project.optional-dependencies]
jax = [
    "jax>=0.4.20,<1.0",
]
docs = [
    "mkdocs>=1.5",
    "mkdocs-material>=9.0",
    "mkdocstrings[python]>=0.24",
]
dev = [
    "pytest>=7.0",
    "ruff>=0.9.0",
    "cogrid[docs]",
]
all = [
    "cogrid[jax]",
    "cogrid[dev]",
]

[project.urls]
Homepage = "https://github.com/chasemcd/cogrid"
Repository = "https://github.com/chasemcd/cogrid"

[tool.setuptools.dynamic]
version = {attr = "cogrid.__version__"}

[tool.setuptools.packages.find]
include = ["cogrid*"]

[tool.ruff]
target-version = "py310"
line-length = 100

[tool.ruff.lint]
select = ["E", "F", "I", "UP", "D"]

[tool.ruff.lint.per-file-ignores]
"cogrid/tests/*" = ["D100", "D101", "D102", "D103", "D104", "D107"]
"cogrid/test_*.py" = ["D100", "D101", "D102", "D103", "D104", "D107"]
"cogrid/benchmarks/*" = ["D100", "D101", "D102", "D103", "D104"]
"examples/*" = ["D"]

[tool.ruff.lint.pydocstyle]
convention = "google"

[tool.ruff.format]
docstring-code-format = true

[tool.pytest.ini_options]
testpaths = ["cogrid/tests"]
```

**cogrid/__init__.py** -- Add `__version__ = "0.0.16"` as the FIRST line, before any imports or function definitions. This is critical for setuptools `attr:` dynamic version parsing (uses `ast.literal_eval`). The existing `make()` function remains unchanged below it.

```python
"""CoGrid: Multi-agent grid-world environments for reinforcement learning."""

__version__ = "0.0.16"


def make(environment_id: str, **kwargs):
    ...existing code...
```

**README.md** -- Convert README.rst to Markdown. The current RST is 58 lines. Convert to Markdown with:
- Title as `# CoGrid`
- Logo image as Markdown `![CoGrid Logo](...)` (keep same path)
- Description updated to reflect the current array-based paradigm (not the old Minigrid-based description). Brief: CoGrid is a library for creating multi-agent grid-world environments for RL research, with a functional array-based simulation core, pluggable components (rewards, features, objects), and dual numpy/JAX backend support.
- Installation section with `pip install cogrid` and `pip install cogrid[jax]` for JAX backend
- Badges at top: PyPI version badge (placeholder URL is fine -- `https://img.shields.io/pypi/v/cogrid`), Python version badge, License badge
- Citation block in Markdown code fence
- GIF and logo images as Markdown image syntax
- Remove Minigrid references -- the README should describe CoGrid as it exists today

Do NOT delete README.rst yet -- that happens in Task 2 alongside the other legacy file removals.
  </action>
  <verify>
Run:
```bash
python -c "import cogrid; print(cogrid.__version__)"  # Should print 0.0.16
head -5 pyproject.toml  # Should show [build-system]
head -5 README.md  # Should show Markdown content
```
  </verify>
  <done>
    - pyproject.toml contains complete PEP 621 metadata, all 4 optional extras groups, ruff config with per-file-ignores, and pytest config
    - `cogrid/__init__.py` defines `__version__ = "0.0.16"` as the first statement
    - README.md exists with Markdown formatting, badges, and updated project description
  </done>
</task>

<task type="auto">
  <name>Task 2: Remove legacy files, clean build artifacts, verify installation</name>
  <files>
    setup.py
    setup.cfg
    MANIFEST.in
    requirements.txt
    docs/requirements.txt
    update_pypi.sh
    .readthedocs.yaml
    README.rst
  </files>
  <action>
**Remove legacy files from git** (8 files total):

```bash
git rm setup.py setup.cfg MANIFEST.in requirements.txt docs/requirements.txt update_pypi.sh .readthedocs.yaml README.rst
```

These are replaced by:
- setup.py, setup.cfg, MANIFEST.in, requirements.txt, docs/requirements.txt -> pyproject.toml
- update_pypi.sh -> Removed (CI/CD in Phase 28 replaces manual publishing)
- .readthedocs.yaml -> Removed (references deleted Sphinx config; docs phase will create new if needed)
- README.rst -> README.md (created in Task 1)

**Clean stale build artifacts from disk** (not tracked by git, but should be removed):

```bash
rm -rf build/ dist/ cogrid.egg-info/
```

**Verify installation**:

```bash
# Uninstall and reinstall to ensure pyproject.toml is used (not cached setup.py)
pip install -e . 2>&1 | tail -5

# Verify version
python -c "import cogrid; print(cogrid.__version__)"

# Verify pip show reflects pyproject.toml metadata
pip show cogrid | head -10

# Verify no legacy files remain
ls setup.py setup.cfg MANIFEST.in requirements.txt 2>&1  # Should all report "No such file"
```

**Important:** After `git rm`, the files are staged for removal. The pip install must happen AFTER the git rm so that setuptools does not find the old setup.py via fallback.
  </action>
  <verify>
Run:
```bash
# Installation works
pip install -e . && python -c "import cogrid; print(cogrid.__version__)"

# Legacy files gone from working tree
test ! -f setup.py && test ! -f setup.cfg && test ! -f MANIFEST.in && test ! -f requirements.txt && echo "Legacy files removed"

# Build artifacts gone
test ! -d build && test ! -d dist && test ! -d cogrid.egg-info && echo "Build artifacts clean"

# Tests still pass
python -m pytest cogrid/tests/ -x -q 2>&1 | tail -5
```
  </verify>
  <done>
    - All 8 legacy files removed from git (setup.py, setup.cfg, MANIFEST.in, requirements.txt, docs/requirements.txt, update_pypi.sh, .readthedocs.yaml, README.rst)
    - Build artifacts (build/, dist/, cogrid.egg-info/) cleaned from disk
    - `pip install -e .` succeeds using pyproject.toml only
    - `python -c "import cogrid; print(cogrid.__version__)"` prints 0.0.16
    - Existing tests pass
  </done>
</task>

</tasks>

<verification>
1. `pip install -e .` completes successfully -- pyproject.toml is the sole packaging config
2. `pip install -e ".[dev]"` installs pytest + ruff + mkdocs stack
3. `python -c "import cogrid; print(cogrid.__version__)"` prints `0.0.16`
4. `git status` shows no legacy packaging files (setup.py, setup.cfg, MANIFEST.in, requirements.txt, docs/requirements.txt, update_pypi.sh, .readthedocs.yaml)
5. README.md exists with Markdown formatting
6. `python -m pytest cogrid/tests/ -x -q` passes (no regressions)
</verification>

<success_criteria>
- pyproject.toml is the single packaging configuration file with PEP 621 metadata, 4 optional extras, ruff config, and pytest config
- `cogrid.__version__` returns "0.0.16"
- All 8 legacy files removed from repository
- Build artifacts cleaned from disk
- Installation and tests work with pyproject.toml only
- README.md exists with updated content
</success_criteria>

<output>
After completion, create `.planning/phases/25-packaging-consolidation/25-01-SUMMARY.md`
</output>
