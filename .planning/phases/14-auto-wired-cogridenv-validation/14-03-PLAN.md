---
phase: 14-auto-wired-cogridenv-validation
plan: 03
type: execute
wave: 3
depends_on: ["14-02"]
files_modified:
  - cogrid/envs/overcooked/array_config.py
  - cogrid/envs/overcooked/array_rewards.py
  - cogrid/core/scope_config.py
autonomous: true

must_haves:
  truths:
    - "Only one environment configuration path exists: auto-wiring from component registries"
    - "No production code references manual-wiring functions (build_overcooked_scope_config, _build_type_ids, compute_rewards dispatcher, get_scope_config)"
    - "All tests and examples run successfully after cleanup"
  artifacts:
    - path: "cogrid/envs/overcooked/array_config.py"
      provides: "Only contains functions still referenced by component classmethods: overcooked_tick_state, overcooked_interaction_body, _extract_overcooked_state, build_overcooked_extra_state"
    - path: "cogrid/envs/overcooked/array_rewards.py"
      provides: "Only contains standalone reward functions and ArrayReward subclasses -- no compute_rewards dispatcher"
  key_links:
    - from: "cogrid/envs/overcooked/array_config.py remaining functions"
      to: "cogrid/envs/overcooked/overcooked_grid_objects.py Pot classmethods"
      via: "Pot.build_tick_fn returns overcooked_tick_state, Pot.build_interaction_fn returns overcooked_interaction_body"
      pattern: "overcooked_tick_state|overcooked_interaction_body"
---

<objective>
Delete all dead manual-wiring code that has been replaced by auto-wiring. This includes build_overcooked_scope_config(), _build_type_ids(), compute_rewards() dispatcher, and the entire scope_config.py module.

Purpose: Eliminates dead code paths that would confuse future developers. After this plan, there is exactly ONE way to configure environments: the component auto-wiring API. This satisfies Phase 14 Success Criterion 5: "Dead manual-wiring code is deleted from the codebase."

Output: Cleaned-up array_config.py, array_rewards.py, deleted scope_config.py, all tests passing.
</objective>

<execution_context>
@/Users/chasemcd/.claude/get-shit-done/workflows/execute-plan.md
@/Users/chasemcd/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/14-auto-wired-cogridenv-validation/14-RESEARCH.md
@.planning/phases/14-auto-wired-cogridenv-validation/14-01-SUMMARY.md
@.planning/phases/14-auto-wired-cogridenv-validation/14-02-SUMMARY.md
@cogrid/envs/overcooked/array_config.py
@cogrid/envs/overcooked/array_rewards.py
@cogrid/core/scope_config.py
</context>

<tasks>

<task type="auto">
  <name>Task 1: Delete dead manual-wiring code and scope_config module</name>
  <files>cogrid/envs/overcooked/array_config.py, cogrid/envs/overcooked/array_rewards.py, cogrid/core/scope_config.py</files>
  <action>
  Before deleting anything, verify no remaining callers exist with grep:

  ```bash
  grep -rn "build_overcooked_scope_config" cogrid/ examples/ --include="*.py"
  grep -rn "compute_rewards" cogrid/envs/overcooked/array_rewards.py
  grep -rn "from cogrid.core.scope_config import" cogrid/ --include="*.py"
  grep -rn "get_scope_config" cogrid/ --include="*.py"
  grep -rn "_build_type_ids" cogrid/ --include="*.py"
  ```

  The only remaining callers should be:
  - The functions themselves (definitions)
  - The Phase 14 parity test (test_phase14_validation.py) which imports build_overcooked_scope_config for comparison -- this import must be removed/updated as part of this task
  - Documentation/comments referencing the old approach

  **Delete from cogrid/envs/overcooked/array_config.py:**
  - `build_overcooked_scope_config()` function (the manual scope_config builder)
  - `_build_type_ids()` function (manual type_id assembly)
  - Any imports used only by these deleted functions

  **KEEP in array_config.py:**
  - `overcooked_tick_state()` -- referenced by Pot.build_tick_fn() classmethod
  - `overcooked_interaction_body()` -- referenced by Pot.build_interaction_fn() classmethod
  - `_extract_overcooked_state()` -- may still be used by rendering/Grid path
  - `build_overcooked_extra_state()` -- referenced by Pot.build_extra_state_builder() classmethod
  - `build_overcooked_static_tables()` -- referenced by Pot.build_static_tables() classmethod
  - Any helper functions called by the kept functions

  **Delete from cogrid/envs/overcooked/array_rewards.py:**
  - `compute_rewards()` dispatcher function (the manual reward composition function)
  - Any imports used only by this deleted function

  **KEEP in array_rewards.py:**
  - Standalone reward functions: `delivery_reward()`, `onion_in_pot_reward()`, `soup_in_dish_reward()`
  - ArrayReward subclasses: `DeliveryReward`, `OnionInPotReward`, `SoupInDishReward`
  - All imports needed by the kept functions/classes

  **Delete cogrid/core/scope_config.py entirely:**
  - The entire module. Remove the file.

  **Update references:**
  - Check `cogrid/core/layout_parser.py` docstring references to `get_scope_config` -- update documentation to reference auto-wiring instead. Do NOT change any functional code in layout_parser.py (it has its own `get_symbols()` fallback that works without scope_config.py).
  - Check `cogrid/core/grid_utils.py` docstring references -- update if they mention `get_scope_config()`.
  - Check `cogrid/core/interactions.py` docstring references -- update if needed.
  - Check `test_phase14_validation.py` -- it should NOT import `build_overcooked_scope_config` (the 14-02 revision uses determinism + invariant checks, not manual-vs-auto comparison). If any reference remains, remove it.
  - Also check `cogrid/core/array_rewards.py` for the `compose_rewards()` function -- if nothing calls it and it's been superseded by the autowire composed compute_fn, delete it too. Grep first: `grep -rn "compose_rewards" cogrid/ --include="*.py"`.

  **Verify no `__init__.py` files still import from scope_config.py.** Check `cogrid/core/__init__.py` if it exists.
  </action>
  <verify>
  Run these verification steps:
  1. `grep -rn "build_overcooked_scope_config" cogrid/ examples/ --include="*.py"` -- zero matches
  2. `grep -rn "from cogrid.core.scope_config" cogrid/ --include="*.py"` -- zero matches
  3. `grep -rn "compute_rewards" cogrid/envs/overcooked/array_rewards.py` -- zero matches (the function is gone)
  4. `test -f cogrid/core/scope_config.py && echo "EXISTS" || echo "DELETED"` -- should print DELETED
  5. `python -m pytest cogrid/tests/ cogrid/envs/ -x -q` -- all tests pass
  6. `python examples/goal_finding.py` -- runs without error
  </verify>
  <done>All dead manual-wiring code is deleted. scope_config.py is removed. array_config.py retains only functions referenced by component classmethods. array_rewards.py retains only standalone reward functions and ArrayReward subclasses. All tests pass. Zero references to deleted functions remain in codebase.</done>
</task>

</tasks>

<verification>
Specific deletions to verify (moved from truths -- these are implementation details, not outcomes):
1. `grep -rn "build_overcooked_scope_config" cogrid/ examples/ --include="*.py"` -- zero matches in production code (array_config.py function deleted)
2. `grep -rn "_build_type_ids" cogrid/ examples/ --include="*.py"` -- zero matches (array_config.py function deleted)
3. `grep -rn "^def compute_rewards\|^    def compute_rewards" cogrid/envs/overcooked/array_rewards.py` -- zero matches (dispatcher function deleted)
4. `test -f cogrid/core/scope_config.py` -- file does not exist (entire module deleted)
5. `grep -rn "from cogrid.core.scope_config import\|get_scope_config" cogrid/ --include="*.py"` -- zero matches
6. `python -m pytest cogrid/tests/ cogrid/envs/ -x -q` -- all tests pass
7. `python examples/goal_finding.py` -- runs without error
8. `python -c "from cogrid.core.autowire import build_scope_config_from_components; print(build_scope_config_from_components('overcooked').keys())"` -- prints expected dict keys (auto-wiring is the sole path)
</verification>

<success_criteria>
All dead manual-wiring code is deleted. The codebase has exactly ONE environment configuration path: auto-wiring from component registries. All tests pass. Phase 14 Success Criterion 5 is satisfied.
</success_criteria>

<output>
After completion, create `.planning/phases/14-auto-wired-cogridenv-validation/14-03-SUMMARY.md`
</output>
